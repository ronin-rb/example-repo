#!/usr/bin/env -S ronin-exploits run -f

require 'ronin/exploits/exploit'
require 'ronin/exploits/mixins/has_payload'

module Ronin
  module Exploits
    class ExampleExploit < Exploit

      include Mixins::HasPayload

      register 'example_exploit'

      quality :poc
      release_date    '2033-05-09'
      disclosure_date '2023-05-09'
      # advisory 'CVE-YYYY-NNNN'
      # advisory 'GHSA-XXXXXX'

      author 'Postmodern', email: 'postmodern.mod3@gmail.com'
      summary "Example exploit"
      description <<~DESC
        An example exploit.
      DESC
      references [
        "https://github.com/ronin-rb/example-repo",
        "https://github.com/ronin-rb/ronin-exploits#examples"
      ]

      #
      # Test whether the target systme is vulnerable.
      #
      def test
        NotVulnerable('this is an example exploit')
      end

      def build
        @buffer = "EXAMPLE-EXPLOIT-HERE #{@payload}"
      end

      def launch
      end

      def cleanup
      end

    end
  end
end
